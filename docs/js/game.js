!function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vector3ToArrayIndex=function(e,t,i,s=32){return s*s*e+s*t+i},t.arrayIndexToVector3=function(e,t=32){return new BABYLON.Vector3(e/(t*t)>>0,e/t%t>>0,e%t>>0)},t.vector2ToArrayIndex=function(e,t,i=32){return i*e+t},t.arrayIndexToVector2=function(e,t=32){return new BABYLON.Vector2(e/t>>0,e%t>>0)},t.fillArrayWithEmptiness=function(e,t=32768){e.length=0;for(let i=0;i<t;i++)e.push(0)},t.getNextNonZeroValueIndex=function(e,t){for(let i=t+1;i<e.length;i++)if(0!==e[i])return[i,e[i]];return[-1,-1]},t.forX=function(e,t,i,s=1){for(let r=e;r<t;r+=s)i(r)},t.getLocalPosition=function(e){const t=e.x%32,i=(e.x-t)/32,s=e.y%32,r=(e.y-s)/32,n=e.z%32,o=(e.z-n)/32;return[new BABYLON.Vector3(i,r,o),new BABYLON.Vector3(t>>0,s>>0,n>>0)]}},function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))(function(r,n){function o(e){try{h(s.next(e))}catch(e){n(e)}}function a(e){try{h(s.throw(e))}catch(e){n(e)}}function h(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}h((s=s.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=i(2),n=i(4);class o{init(){return s(this,void 0,void 0,function*(){this.engine=new r.VoxelEngine({canvasElement:"app"}),this.engine.initialize().start();const e=yield(yield fetch("assets/conf/default/material-info.json")).json(),t=yield(yield fetch("assets/conf/default/blocks-mapping.json")).json(),i=yield(yield fetch("assets/conf/default/blocks-definition.json")).json();this.engine.loadMaterial(Object.assign({},e,i,t));this.simplexMap=n.ChunkBuilder.createSimplexNoiseMap(640,640,32,.01),this.engine.evtChunkIsNeeded=e=>{console.info("Asked for chunk ",e.x,e.y,e.z);const t=n.ChunkBuilder.inflateSimplexNoiseMapToChunk(this.simplexMap,e.x,e.y,e.z);return console.log(t),t}})}}t.Game=o,(new o).init()},function(e,t,i){"use strict";var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const r=i(3),n=s(i(0)),o=i(6);t.VoxelEngine=class{constructor(e){this.region={chunks:{}},this.lastPosition=new BABYLON.Vector3(0,0,0),this._gameMaterialRepo={},this.first=!0,this.hasBeenInit=!0,this._options=Object.assign({},e)}initialize(){if(this._engine)return console.info("Engine already started"),this;this._canvas=document.getElementById(this._options.canvasElement),this._engine=new BABYLON.Engine(this._canvas,!0),this._scene=new BABYLON.Scene(this._engine),this._scene.blockMaterialDirtyMechanism=!0,this._scene.ambientColor=new BABYLON.Color3(.3,.3,.3),this._scene.clearColor=BABYLON.Color4.FromColor3(new BABYLON.Color3(135/255,206/255,250/255)),this._camera=new BABYLON.UniversalCamera("MainCharcter",new BABYLON.Vector3(160,16,160),this._scene),this._camera.setTarget(new BABYLON.Vector3(1,0,0)),this._camera.attachControl(this._canvas,!1),this._camera.inputs.removeByType("FreeCameraKeyboardMoveInput");const e=new r.FreeCameraKeyboardRotateInput(this._camera);this._camera.inputs.add(e),this._camera.inertia=0,this._camera.angularSensibility=500;var t=BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI");const i=()=>void 0,s=(s,r,n,o=!0)=>{var a=BABYLON.GUI.Button.CreateSimpleButton("but1","");a.width="60px",a.height="60px",a.left=`${r}px`,a.top=`${n}px`,a.cornerRadius=20,a.thickness=1,a.horizontalAlignment=o?BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT:BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT,a.verticalAlignment=BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM,a.onPointerDownObservable.add(()=>{e.forceKeyDown(s,i)}),a.onPointerOutObservable.add(()=>{e.forceKeyUp(s,i)}),a.onPointerUpObservable.add(()=>{e.forceKeyUp(s,i)}),t.addControl(a)};return s(65,20,-100),s(68,90,-100),s(87,55,-170),s(83,55,-30),s(37,-160,-100,!1),s(39,-90,-100,!1),s(32,-125,-170,!1),s(16,-125,-30,!1),s(38,-10,-170,!1),s(40,-10,-30,!1),this}loadMaterial(e){this._gameMaterialRepo[e.name]=e,this.processMaterial(e.name)}processMaterial(e){const t=this._gameMaterialRepo[e];t.texture=new BABYLON.Texture(t.texturePath,this._scene,void 0,void 0,1),t.material=new BABYLON.StandardMaterial(t.name,this._scene),t.texture.hasAlpha=!0,t.material.diffuseTexture=t.texture,t.material.ambientColor=BABYLON.Color3.White(),t.material.diffuseTexture.level=4,t.sps=new BABYLON.SolidParticleSystem(e,this._scene)}getTex(e,t){return new BABYLON.Vector4(1/16*e+1/512,1/16*t+1/512,1/16*e+1/16-1/512,1/16*t+1/16-1/512)}updateGameLoop(){const[e,t]=n.getLocalPosition(this._camera.position);if(this.evtChunkIsNeeded){if(this.first){this.first=!1;for(let e=0;e<=5;e++)for(let t=0;t<=5;t++)if(!this.region.chunks[`${e}-0-${t}`]){const i=this.evtChunkIsNeeded(new BABYLON.Vector3(e,0,t));this.addChunkToScene("default",i,new BABYLON.Vector3(32*e,0,32*t)),this.hasBeenInit&&this._scene.selectionOctree.addMesh(this.addChunkToScene("default",i,new BABYLON.Vector3(32*e,0,32*t))),this.region.chunks[`${e}-0-${t}`]=i,this.hasBeenInit&&this._scene.updateTransformMatrix(),this.hasBeenInit&&this._scene.createOrUpdateSelectionOctree()}}else if(!this.region.chunks[`${e.x}-${e.y}-${e.z}`]){const t=this.evtChunkIsNeeded(e);this._scene.selectionOctree.addMesh(this.addChunkToScene("default",t,new BABYLON.Vector3(32*e.x,32*e.y,32*e.z))),this.hasBeenInit&&(this.region.chunks[`${e.x}-${e.y}-${e.z}`]=t),this.hasBeenInit&&this._scene.updateTransformMatrix(),this._scene.createOrUpdateSelectionOctree()}1===this.region.chunks[`${e.x}-${e.y}-${e.z}`].data[n.vector3ToArrayIndex(t.x,t.y,t.z,32)]||1===this.region.chunks[`${e.x}-${e.y}-${e.z}`].data[n.vector3ToArrayIndex(t.x,t.y-1,t.z,32)]||1===this.region.chunks[`${e.x}-${e.y}-${e.z}`].data[n.vector3ToArrayIndex(t.x,t.y-2,t.z,32)]?(this._camera.position.x=this.lastPosition.x,this._camera.position.y=this.lastPosition.y,this._camera.position.z=this.lastPosition.z,console.log("collide")):this.lastPosition=this._camera.position.clone()}}gameLoop(){}addChunkToScene(e,t,i){this.globalSPS||(this.globalSPS=new BABYLON.SolidParticleSystem("s",this._scene));let s=100*Math.random()%15>>0,r=100*Math.random()%15>>0;s=15,r=3;const a=BABYLON.MeshBuilder.CreatePlane("box",{height:1,width:1,frontUVs:this.getTex(11,14),sideOrientation:BABYLON.Mesh.DOUBLESIDE},this._scene),h=BABYLON.MeshBuilder.CreatePlane("box",{height:1,width:1,frontUVs:this.getTex(3,15),sideOrientation:BABYLON.Mesh.DOUBLESIDE},this._scene),c=BABYLON.MeshBuilder.CreateTiledBox("box",{width:1,height:1,depth:1,faceUV:[this.getTex(13,3),this.getTex(13,3),this.getTex(13,3),this.getTex(13,3),this.getTex(13,3),this.getTex(13,3)]},this._scene),d=new BABYLON.SolidParticleSystem(performance.now().toString(),this._scene);let l=0;for(let e=0;e<t.rcDataSize;e++){let[e,i]=n.getNextNonZeroValueIndex(t.rcData,l);l=e,(i&o.Side.Top)===o.Side.Top&&d.addShape(a,1,{positionFunction:(e,t,i)=>{e.position=n.arrayIndexToVector3(l),e.rotation.x=BABYLON.Angle.FromDegrees(90).radians(),e.position.y+=.5,e.position.z+=1}}),(i&o.Side.Bottom)===o.Side.Bottom&&d.addShape(h,1,{positionFunction:(e,t,i)=>{e.position=n.arrayIndexToVector3(l),e.rotation.x=BABYLON.Angle.FromDegrees(-90).radians(),e.position.y-=.5,e.position.z+=1}}),(i&o.Side.Forward)===o.Side.Forward&&d.addShape(h,1,{positionFunction:(e,t,i)=>{e.position=n.arrayIndexToVector3(l),e.rotation.y=BABYLON.Angle.FromDegrees(90).radians(),e.position.z+=1,e.position.x-=.5}}),(i&o.Side.Backward)===o.Side.Backward&&d.addShape(h,1,{positionFunction:(e,t,i)=>{e.position=n.arrayIndexToVector3(l),e.rotation.y=BABYLON.Angle.FromDegrees(-90).radians(),e.position.z+=1,e.position.x+=.5}}),(i&o.Side.Left)===o.Side.Left&&d.addShape(h,1,{positionFunction:(e,t,i)=>{e.position=n.arrayIndexToVector3(l),e.rotation.y=BABYLON.Angle.FromDegrees(180).radians(),e.position.z+=1.5}}),(i&o.Side.Right)===o.Side.Right&&d.addShape(h,1,{positionFunction:(e,t,i)=>{e.position=n.arrayIndexToVector3(l),e.position.z+=.5}})}return a.dispose(),h.dispose(),n.forX(0,32,e=>{n.forX(0,32,i=>{t.rcData[n.vector3ToArrayIndex(e,6,i)]})}),c.dispose(),d.mesh||d.buildMesh(),d.mesh.material||(d.mesh.material=this._gameMaterialRepo[e].material),d.mesh.position=i,d.mesh.computeWorldMatrix(),d.setParticles(),setInterval(()=>{if(d.mesh.isVisible=d.mesh.isInFrustum(this._scene.frustumPlanes),d.mesh.isVisible){let e=d.mesh.position,t=this._camera.position,i=160;(Math.abs(e.x-t.x)>i||Math.abs(e.y-t.y)>i||Math.abs(e.z-t.z)>i)&&(d.mesh.isVisible=!1)}},100),d.mesh.freezeNormals(),d.mesh.freezeWorldMatrix(),d.mesh}start(){let e=0;const t=document.createElement("div");t.style.position="absolute",t.style.width="25px",t.style.height="25px",t.style.top="0px",t.style.left="0px",t.style.backgroundColor="white",t.style.textAlign="center",t.style.lineHeight="25px",t.style.zIndex="9999",document.body.appendChild(t),this._scene.createOrUpdateSelectionOctree(8,1),this.hasBeenInit=!0,this._engine.runRenderLoop(()=>{this.updateGameLoop(),this._scene.createOrUpdateSelectionOctree(),this._scene.render(),e++}),window.game=this,setInterval(()=>(t.innerText=e.toString(),e=0),1e3),window.addEventListener("resize",()=>{this._engine.resize()})}}},function(e,t,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.KeyLeft="KeyLeft",e.KeyRight="KeyRight",e.KeyForward="KeyForward",e.KeyBackward="KeyBackward",e.KeyMoveUp="KeyMoveUp",e.KeyMoveDown="KeyMoveDown",e.KeyTurnLeft="KeyTurnLeft",e.KeyTurnRight="KeyTurnRight",e.KeyUp="KeyUp",e.KeyDown="KeyDown"}(s||(s={}));t.FreeCameraKeyboardRotateInput=class{constructor(e){this._noPreventDefault=!1,this._keys=[],this._keysLeft=[65],this._keysRight=[68],this._keysForward=[87],this._keysBackward=[83],this._keysMoveUp=[32],this._keysMoveDown=[16],this._keysTurnLeft=[39],this._keysTurnRight=[37],this._keysUp=[38],this._keysDown=[40],this._sensibility=.005,this._movementSpeed=.5,this._onKeyDown=e=>{-1===this._keysLeft.indexOf(e.keyCode)&&-1===this._keysRight.indexOf(e.keyCode)&&-1===this._keysForward.indexOf(e.keyCode)&&-1===this._keysBackward.indexOf(e.keyCode)&&-1===this._keysMoveUp.indexOf(e.keyCode)&&-1===this._keysMoveDown.indexOf(e.keyCode)&&-1===this._keysTurnLeft.indexOf(e.keyCode)&&-1===this._keysTurnRight.indexOf(e.keyCode)&&-1===this._keysUp.indexOf(e.keyCode)&&-1===this._keysDown.indexOf(e.keyCode)||(-1===this._keys.indexOf(e.keyCode)&&this._keys.push(e.keyCode),this._noPreventDefault||e.preventDefault())},this._onKeyUp=e=>{if(-1!==this._keysLeft.indexOf(e.keyCode)||-1!==this._keysRight.indexOf(e.keyCode)||-1!==this._keysForward.indexOf(e.keyCode)||-1!==this._keysBackward.indexOf(e.keyCode)||-1!==this._keysMoveUp.indexOf(e.keyCode)||-1!==this._keysMoveDown.indexOf(e.keyCode)||-1!==this._keysTurnLeft.indexOf(e.keyCode)||-1!==this._keysTurnRight.indexOf(e.keyCode)||-1!==this._keysUp.indexOf(e.keyCode)||-1!==this._keysDown.indexOf(e.keyCode)){var t=this._keys.indexOf(e.keyCode);t>=0&&this._keys.splice(t,1),this._noPreventDefault||e.preventDefault()}},this.camera=e}setKeycode(e,t){switch(t){case s.KeyLeft:this._keysLeft.length=0,this._keysLeft.push(e);break;case s.KeyRight:this._keysRight.length=0,this._keysRight.push(e);break;case s.KeyForward:this._keysForward.length=0,this._keysForward.push(e);break;case s.KeyBackward:this._keysBackward.length=0,this._keysBackward.push(e);break;case s.KeyMoveUp:this._keysMoveUp.length=0,this._keysMoveUp.push(e);break;case s.KeyMoveDown:this._keysMoveDown.length=0,this._keysMoveDown.push(e);break;case s.KeyTurnLeft:this._keysTurnLeft.length=0,this._keysTurnLeft.push(e);break;case s.KeyTurnRight:this._keysTurnRight.length=0,this._keysTurnRight.push(e);break;case s.KeyUp:this._keysUp.length=0,this._keysUp.push(e);break;case s.KeyDown:this._keysDown.length=0,this._keysDown.push(e)}}forceKeyUp(e,t){this._onKeyUp({keyCode:e,preventDefault:t})}forceKeyDown(e,t){this._onKeyDown({keyCode:e,preventDefault:t})}_onLostFocus(e){this._keys=[]}getClassName(){return"FreeCameraKeyboardRotateInput"}getSimpleName(){return"keyboardRotate"}toggleFullScreen(){var e=window.document,t=e.documentElement,i=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,s=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?s.call(e):i.call(t)}attachControl(e,t){this._noPreventDefault=!!t,e.tabIndex=1,e.addEventListener("keydown",this._onKeyDown,!1),e.addEventListener("keyup",this._onKeyUp,!1),BABYLON.Tools.RegisterTopRootEvents([{name:"blur",handler:this._onLostFocus}]);let i=!1;function s(){void 0!==document.fullscreen?i=document.fullscreen:void 0!==document.mozFullScreen?i=document.mozFullScreen:void 0!==document.webkitIsFullScreen?i=document.webkitIsFullScreen:void 0!==document.msIsFullScreen&&(i=document.msIsFullScreen)}document.addEventListener("fullscreenchange",s,!1),document.addEventListener("mozfullscreenchange",s,!1),document.addEventListener("webkitfullscreenchange",s,!1),document.addEventListener("msfullscreenchange",s,!1),document.querySelector("canvas").onclick=function(){i||BABYLON.Tools.RequestFullscreen(e)},this.camera.getScene().onPointerDown=e=>{{let e=document.querySelector("canvas");e.requestPointerLock=e.requestPointerLock||e.msRequestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock&&e.requestPointerLock()}}}detachControl(e){e&&(e.removeEventListener("keydown",this._onKeyDown),e.removeEventListener("keyup",this._onKeyUp),BABYLON.Tools.UnregisterTopRootEvents([{name:"blur",handler:this._onLostFocus}]),this._keys=[])}checkInputs(){if(!this.camera)return;const e=this.camera;for(let r=0;r<this._keys.length;r++){const n=this._keys[r],o=e.getTarget().subtract(e.position).x,a=e.getTarget().subtract(e.position).y,h=e.getTarget().subtract(e.position).z;if(-1===this._keysLeft.indexOf(n))-1===this._keysRight.indexOf(n)?-1===this._keysForward.indexOf(n)?-1===this._keysBackward.indexOf(n)?-1===this._keysMoveUp.indexOf(n)?-1===this._keysMoveDown.indexOf(n)?-1===this._keysTurnLeft.indexOf(n)?-1===this._keysTurnRight.indexOf(n)?-1===this._keysUp.indexOf(n)?-1===this._keysDown.indexOf(n)||(e.cameraRotation.x+=4*this._sensibility):e.cameraRotation.x-=4*this._sensibility:e.cameraRotation.y-=4*this._sensibility:e.cameraRotation.y+=4*this._sensibility:e.cameraDirection.y-=.5*this._movementSpeed:e.cameraDirection.y+=.5*this._movementSpeed:(e.cameraDirection.x-=this._movementSpeed*o,e.cameraDirection.y-=this._movementSpeed*a,e.cameraDirection.z-=this._movementSpeed*h):(e.cameraDirection.x+=this._movementSpeed*o,e.cameraDirection.y+=this._movementSpeed*a,e.cameraDirection.z+=this._movementSpeed*h):(t=h*h,i=o*o,s=1/Math.sqrt(t+i),e.cameraDirection.x+=this._movementSpeed*h*s,e.cameraDirection.z-=this._movementSpeed*o*s);else{var t=h*h,i=o*o,s=1/Math.sqrt(t+i);e.cameraDirection.x-=this._movementSpeed*h*s,e.cameraDirection.z+=this._movementSpeed*o*s}}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=i(5),r=i(0),n=i(6);class o{static create(e=32){const t={data:[],dataSize:0,rcData:[],rcDataSize:0,size:e};return r.fillArrayWithEmptiness(t.data,e*e*e),t}static createSimplexNoiseMap(e,t,i=32,n=.015,o=4,a=2,h=1){const c=new s.SimplexNoise;c.init(),c.noiseDetail(45,.34567);const d=new Array;r.fillArrayWithEmptiness(d,e*t);let l=[];for(let s=0;s<e;s++){for(let o=0;o<t;o++)d[r.vector2ToArrayIndex(s,o,e)]=c.noise(s*n,o*n)*i/1.34>>0;l.length=0}return d}static inflateSimplexNoiseMapToChunk(e,t,i,s,n=32){const a=o.create(n);return r.forX(t*n,t*n+n,t=>{r.forX(s*n,s*n+n,s=>{let o=e[r.vector2ToArrayIndex(t,s,Math.sqrt(e.length))]-i*n;o<0&&(o=0),r.forX(i,o,e=>{a.data[r.vector3ToArrayIndex(t%32,e%32,s%32,n)]=1,a.dataSize++})})}),[a.rcData,a.rcDataSize]=o.simplifyMatrix3D(a.data),a}static simplifyMatrix3D(e){let t=0;const i=new Array,s=Math.cbrt(e.length),o=(e,t,i,n)=>{return!(t<0||(t>=s||i<0||i>=s||n<0||n>=s))&&0!==e[r.vector3ToArrayIndex(t,i,n,s)]};return e.forEach((a,h)=>{let c=i.push(a)-1;if(0===a)return;let d=63;const l=r.arrayIndexToVector3(h,s);o(e,l.x+1,l.y,l.z)&&(d-=n.Side.Backward),o(e,l.x-1,l.y,l.z)&&(d-=n.Side.Forward),o(e,l.x,l.y+1,l.z)&&(d-=n.Side.Top),o(e,l.x,l.y-1,l.z)&&(d-=n.Side.Bottom),o(e,l.x,l.y,l.z-1)&&(d-=n.Side.Right),o(e,l.x,l.y,l.z+1)&&(d-=n.Side.Left),i[c]=d,0!==d&&t++,0===l.y&&(i[c]=0)}),[i,t]}}t.ChunkBuilder=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SimplexNoise=class{constructor(){this.iOctaves=1,this.fPersistence=.5,this.F2=.5*(Math.sqrt(3)-1),this.G2=(3-Math.sqrt(3))/6,this.F3=1/3,this.G3=1/6,this.F4=(Math.sqrt(5)-1)/4,this.G4=5-Math.sqrt(5)/20,this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512),this.p=new Uint8Array(256),this.grad3=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),this.grad4=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0])}octaveFreq(){let e,t;this.aOctFreq=new Array,this.aOctPers=new Array,this.fPersMax=0;for(var i=0;i<this.iOctaves;i++)e=Math.pow(2,i),t=Math.pow(this.fPersistence,i),this.fPersMax+=t,this.aOctFreq.push(e),this.aOctPers.push(t);this.fPersMax=1/this.fPersMax}seed(e){return 1-((e^=e<<13)*(e*e*15731+789221)+1376312589&2147483647)/1073741824}init(){for(var e=0;e<256;e++)this.p[e]=Math.abs(~~(256*this.seed(e)));for(e=0;e<512;e++)this.perm[e]=this.p[255&e],this.permMod12[e]=this.perm[e]%12}noise2D(e,t){var i,s,r,n,o,a=(e+t)*this.F2,h=Math.floor(e+a),c=Math.floor(t+a),d=(h+c)*this.G2,l=e-(h-d),u=t-(c-d);l>u?(n=1,o=0):(n=0,o=1);var y=l-n+this.G2,f=u-o+this.G2,p=l-1+2*this.G2,m=u-1+2*this.G2,_=255&h,g=255&c,k=.5-l*l-u*u;if(k<0)i=0;else{var x=this.permMod12[_+this.perm[g]];i=(k*=k)*k*(this.grad3[x]*l+this.grad3[x+1]*u)}var v=.5-y*y-f*f;if(v<0)s=0;else{var O=this.permMod12[_+n+this.perm[g+o]];s=(v*=v)*v*(this.grad3[O]*y+this.grad3[O+1]*f)}var B=.5-p*p-m*m;if(B<0)r=0;else{var w=this.permMod12[_+1+this.perm[g+1]];r=(B*=B)*B*(this.grad3[w]*p+this.grad3[w+1]*m)}return 70*(i+s+r)}noise3D(e,t,i){var s,r,n,o,a,h,c,d,l,u,y=(e+t+i)*this.F3,f=Math.floor(e+y),p=Math.floor(t+y),m=Math.floor(i+y),_=(f+p+m)*this.G3,g=e-(f-_),k=t-(p-_),x=i-(m-_);g>=k?k>=x?(a=1,h=0,c=0,d=1,l=1,u=0):g>=x?(a=1,h=0,c=0,d=1,l=0,u=1):(a=0,h=0,c=1,d=1,l=0,u=1):k<x?(a=0,h=0,c=1,d=0,l=1,u=1):g<x?(a=0,h=1,c=0,d=0,l=1,u=1):(a=0,h=1,c=0,d=1,l=1,u=0);var v=g-a+this.G3,O=k-h+this.G3,B=x-c+this.G3,w=g-d+2*this.G3,M=k-l+2*this.G3,L=x-u+2*this.G3,S=g-1+3*this.G3,A=k-1+3*this.G3,b=x-1+3*this.G3,T=255&f,F=255&p,D=255&m,C=.6-g*g-k*k-x*x;if(C<0)s=0;else{C*=C;var N=this.permMod12[T+this.perm[F+this.perm[D]]];s=C*C*(this.grad3[N]*g+this.grad3[N+1]*k+this.grad3[N+2]*x)}var I=.6-v*v-O*O-B*B;if(I<0)r=0;else{I*=I;var P=this.permMod12[T+a+this.perm[F+h+this.perm[D+c]]];r=I*I*(this.grad3[P]*v+this.grad3[P+1]*O+this.grad3[P+2]*B)}var R=.6-w*w-M*M-L*L;if(R<0)n=0;else{R*=R;var z=this.permMod12[T+d+this.perm[F+l+this.perm[D+u]]];n=R*R*(this.grad3[z]*w+this.grad3[z+1]*M+this.grad3[z+2]*L)}var K=.6-S*S-A*A-b*b;if(K<0)o=0;else{K*=K;var G=this.permMod12[T+1+this.perm[F+1+this.perm[D+1]]];o=K*K*(this.grad3[G]*S+this.grad3[G+1]*A+this.grad3[G+2]*b)}return 32*(s+r+n+o)}noise4D(e,t,i,s){var r,n,o,a,h,c,d,l,u,y,f,p,m,_,g,k,x,v=(e+t+i+s)*this.F4,O=Math.floor(e+v),B=Math.floor(t+v),w=Math.floor(i+v),M=Math.floor(s+v),L=(O+B+w+M)*this.G4,S=e-(O-L),A=t-(B-L),b=i-(i-L),T=s-(s-L),F=0,D=0,C=0,N=0;S>A?F++:D++,S>b?F++:C++,S>T?F++:N++,A>b?D++:C++,A>T?D++:N++,b>T?C++:N++,d=D>=3?1:0,l=C>=3?1:0,u=N>=3?1:0,y=F>=2?1:0,f=D>=2?1:0,p=C>=2?1:0,m=N>=2?1:0,_=F>=1?1:0,g=D>=1?1:0,k=C>=1?1:0,x=N>=1?1:0;var I=S-(c=F>=3?1:0)+this.G4,P=A-d+this.G4,R=b-l+this.G4,z=T-u+this.G4,K=S-y+2*this.G4,G=A-f+2*this.G4,U=b-p+2*this.G4,Y=T-m+2*this.G4,E=S-_+3*this.G4,q=A-g+3*this.G4,V=b-k+3*this.G4,j=T-x+3*this.G4,$=S-1+4*this.G4,X=A-1+4*this.G4,W=b-1+4*this.G4,Z=T-1+4*this.G4,H=255&O,J=255&B,Q=255&w,ee=255&M,te=.6-S*S-A*A-b*b-T*T;if(te<0)r=0;else{te*=te;var ie=this.perm[H+this.perm[J+this.perm[Q+this.perm[ee]]]]%32;r=te*te*(this.grad4[ie]*S+this.grad4[ie]*A+this.grad4[ie]*b+this.grad4[ie]*T)}var se=.6-I*I-P*P-R*R-z*z;if(se<0)n=0;else{se*=se;var re=this.perm[H+c+this.perm[J+d+this.perm[Q+l+this.perm[ee+u]]]]%32;n=se*se*(this.grad4[re]*I+this.grad4[re]*P+this.grad4[re]*R+this.grad4[re]*z)}var ne=.6-K*K-G*G-U*U-Y*Y;if(ne<0)o=0;else{ne*=ne;var oe=this.perm[H+y+this.perm[J+f+this.perm[Q+p+this.perm[ee+m]]]]%32;o=ne*ne*(this.grad4[oe]*K+this.grad4[oe]*G+this.grad4[oe]*U+this.grad4[oe]*Y)}var ae=.6-E*E-q*q-V*V-j*j;if(ae<0)a=0;else{ae*=ae;var he=this.perm[H+_+this.perm[J+g+this.perm[Q+k+this.perm[ee+x]]]]%32;a=ae*ae*(this.grad4[he]*E+this.grad4[he]*q+this.grad4[he]*V+this.grad4[he]*j)}var ce=.6-$*$-X*X-W*W-Z*Z;if(ce<0)h=0;else{ce*=ce;var de=this.perm[H+1+this.perm[J+1+this.perm[Q+1+this.perm[ee+1]]]]%32;h=ce*ce*(this.grad4[de]*$+this.grad4[de]*X+this.grad4[de]*W+this.grad4[de]*Z)}return 27*(r+n+o+a+h)}noise(...e){this.fResult=0;let t=e[0],i=e[1],s=e[2],r=e[3];for(let n=0;n<this.iOctaves;n++)switch(this.fFreq=this.aOctFreq[n],this.fPers=this.aOctPers[n],e.length){case 4:this.fResult+=this.fPers*this.noise4D(this.fFreq*t,this.fFreq*i,this.fFreq*s,this.fFreq*r);break;case 3:this.fResult+=this.fPers*this.noise3D(this.fFreq*t,this.fFreq*i,this.fFreq*s);break;default:this.fResult+=this.fPers*this.noise2D(this.fFreq*t,this.fFreq*i)}return.5*(this.fResult*this.fPersMax+1)}noiseDetail(e,t){this.iOctaves=e||this.iOctaves,this.fPersistence=t||this.fPersistence,this.octaveFreq()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Forward=4]="Forward",e[e.Backward=8]="Backward",e[e.Top=16]="Top",e[e.Bottom=32]="Bottom",e[e.Z_Axis=3]="Z_Axis",e[e.X_Axis=12]="X_Axis",e[e.Y_Axis=48]="Y_Axis",e[e.All=63]="All"}(t.Side||(t.Side={}))}]);